<ng-container *ngIf="token$ | async as token">
  <ng-container *ngIf="!(error$ | async); else errorTemplate">
    <ng-container *ngIf="pricePerTokens$ | async as price; else loadingTemplate">
      <ng-container *ngIf="providerUserInfo$ | async as userInfo">
        <div class="page__wrapper row">
          <div class="col-6 offset-3">
            <div class="content__container d-flex flex-column align-items-center justify-content-around">
              <div class="d-flex align-items-center justify-content-center mb-3">
                <img
                  width="75"
                  height="75"
                  src="../../../../../assets/images/reef/reef-token.png" alt="reef-token">
                <img
                  width="60"
                  height="60"
                  src="../../../../../assets/images/{{ token === 'WETH' ? 'eth.png' : 'usdt.png' }}" alt="alt-token">
              </div>
              <div
                class="d-flex flex-column align-items-center justify-content-center mb-4">
                <div class="heading__lg">
                  <img
                    class="mb-1"
                    width="50"
                    height="50"
                    src="../../../../../assets/images/reef/reef-v2.svg" alt="reef-token">
                  & {{ token }}
                </div>
                <div class="subheading__lg">
                  Get UNI-V2 LP Tokens by adding liquidity to the
                  <strong class="font-weight-bold">REEF/{{token}}</strong>
                  pool
                </div>
              </div>
              <div
                class="d-flex flex-column align-items-center mb-4">
                <div class="d-flex justify-content-start align-items-center mb-2">
                  <div class="label__lg align-self-start mr-1">REEF Amount</div>
                  <div class="label__md">
                    (Balance: {{userInfo.reefBalance | number}} REEF)
                  </div>
                </div>
                <input
                  [ngModel]="reefAmount"
                  (ngModelChange)="calcTokenAmount($event, price.TOKEN_PER_REEF)"
                  class="form-control"
                  id="reefAmount"
                  placeholder="0.0" type="number"/>
                <div class="label__md mt-1" *ngIf="reefAmount > userInfo.reefBalance">
                  <span class="font-danger">
                    Insufficient Reef Tokens
                  </span>
                </div>
              </div>
              <div
                class="d-flex flex-column align-items-center mb-4">
                <div class="d-flex justify-content-start align-items-center mb-2">
                  <div class="label__lg align-self-start mr-1">{{ token }} Amount</div>
                  <div *ngIf="token === 'WETH' || token === 'ETH'">
                    <div class="label__md">
                      (Balance: {{userInfo.balance | number}} ETH)
                    </div>
                  </div>
                  <div
                    class="label__md"
                    *ngIf="token !== 'WETH' && token !== 'ETH'">
                    (Balance: {{userTokenBalance | number }} {{ token }})
                  </div>
                </div>
                <input
                  [ngModel]="tokenAmount"
                  (ngModelChange)="calcReefAmount($event, price.REEF_PER_TOKEN)"
                  class="form-control"
                  id="tokenAmount"
                  placeholder="0.0" type="number"/>
                <div *ngIf="token === 'WETH' || token === 'ETH'">
                  <div class="label__md mt-1" *ngIf="tokenAmount > userInfo.balance">
                    <span class="font-danger">
                      Insufficient ETH Coins
                    </span>
                  </div>
                </div>
                <div *ngIf="token !== 'WETH' && token !== 'ETH'">
                  <div class="label__md mt-1" *ngIf="tokenAmount > userTokenBalance">
                    <span class="font-danger">
                      Buy some {{ token }} to execute this Trade
                    </span>
                  </div>
                </div>
              </div>
              <div
                class="d-flex align-items-center justify-content-center mb-4">
                <app-content-box class="w-50">
                  <div class="subheading__md text-dark">Reef per {{ token }}</div>
                  <div class="heading__md text-dark">
                    {{ price.REEF_PER_TOKEN }}
                  </div>
                </app-content-box>
                <app-content-box class="w-50">
                  <div class="subheading__md text-dark">{{ token }} per REEF</div>
                  <div class="heading__md text-dark">
                    {{ price.TOKEN_PER_REEF }}
                  </div>
                </app-content-box>
              </div>
              <div class="d-flex align-items-center justify-content-center">
                <button
                  [disabled]="!reefAmount ||
                  reefAmount > userInfo.reefBalance || reefAmount <= 0
                   || (token === 'WETH' ? tokenAmount > userInfo.balance : tokenAmount > userTokenBalance)"
                  (click)="addLiquidity(token)" class="button-large regular">
                  Add Liquidity
                </button>
              </div>
            </div>
          </div>
        </div>
      </ng-container>
    </ng-container>
  </ng-container>
  <ng-template #loadingTemplate>
    <app-loading [isWholePage]="true"></app-loading>
  </ng-template>

  <ng-template #errorTemplate>
    <app-empty-state
      title="Pool not found"
      subtitle="{{ token }}-REEF Pool is not supported yet.">
    </app-empty-state>
  </ng-template>
</ng-container>
