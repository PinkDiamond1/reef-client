<div
  id="buyReef"
  class="content__container row">
  <div class="col-10 offset-1 my-auto">
    <div class="mb-4">
      <div class="heading__lg mb-2">Buy REEF</div>
      <div class="label__lg mb-2">Enter your amount</div>
      <div class="d-flex align-items-center">
        <input
          [(ngModel)]="tokenAmount"
          (ngModelChange)="onAmountChange($event)"
          class="w-75 form-control mr-2" type="number"/>
        <div class="d-flex align-items-center">
          <img
            *ngIf="selectedToken === 'WETH'"
            alt="token-logo" width="26" height="26" src="../../../../../assets/images/eth.png"/>
          <img
            *ngIf="selectedToken === 'USDT'"
            alt="token-logo" width="26" height="26" src="../../../../../assets/images/usdt.png"/>
          <div class="label__lg mx-1">{{ selectedToken }}</div>
          <mat-select
            [value]="selectedToken"
            (valueChange)="selectedToken = $event; onTokenChange(selectedToken)">
            <mat-option [value]="token.symbol" *ngFor="let token of supportedTokens">
              <div class="d-flex align-items-center">
                <img
                  class="mr-1"
                  width="18"
                  height="18"
                  src='../../../../../assets/images/{{token.src}}' alt="">
                {{ token.symbol }}
              </div>
            </mat-option>
          </mat-select>
        </div>
      </div>
      <div *ngIf="tokenPrices && tokenPrices.totalReefReserve && tokenPrices.REEF_PER_TOKEN" class="mt-1">
        <div
          *ngIf="tokenPrices.REEF_PER_TOKEN * tokenAmount > tokenPrices.totalReefReserve"
          class="label__md font-danger">
          Total REEF Reserve in this pool is {{ tokenPrices.totalReefReserve }} REEF
        </div>
      </div>
    </div>
    <div class="mb-3">
      <div class="heading__lg mb-2">Prices</div>
      <div
        *ngIf="tokenPrices && tokenPrices.REEF_PER_TOKEN; else loadingTemplate"
        class="d-flex justify-content-center">
        <app-content-box class="mb-2 w-50">
          <div class="subheading__md text-dark">Reef per {{ selectedToken }}</div>
          <div class="heading__md text-dark">
            {{ tokenPrices.REEF_PER_TOKEN | number }}
          </div>
        </app-content-box>
        <app-content-box class="w-50">
          <div class="subheading__md text-dark">Reef/USD</div>
          <div class="heading__md text-dark">
            {{ (selectedToken === 'USDT' ? tokenPrices.TOKEN_PER_REEF : tokenPrices.TOKEN_PER_REEF * ethPrice) | number }} USD
          </div>
        </app-content-box>
      </div>
    </div>
    <div
      *ngIf="tokenPrices && tokenPrices.REEF_PER_TOKEN"
      class="mb-4 d-flex align-items-center">
      <div class="subheading__lg mr-1">You receive a minimum of: </div>
      <div class="subheading__lg font-weight-bold d-flex align-items-center">
        <div>
          ~{{ tokenPrices.amountOutMin | number }}
        </div>
        <div class="ml-1">
          <img
            height="20"
            width="20"
            src="../../../../../assets/images/reef/reef-token.png" alt="">
        </div>
      </div>
    </div>
    <div class="d-flex justify-content-center">
      <button
        *ngIf="!loading"
        [disabled]="tokenAmount == 0 || (tokenPrices &&
        tokenPrices.REEF_PER_TOKEN &&
        +tokenPrices.REEF_PER_TOKEN * tokenAmount > +tokenPrices.totalReefReserve)"
        mat-ripple
        (click)="onBuy(tokenAmount)"
        class="button-large regular">
        Buy REEF
      </button>
      <app-loading *ngIf="loading" [diameter]="25"></app-loading>
    </div>
  </div>
</div>

<ng-template #loadingTemplate>
  <app-skeleton-loading
    count="2"
    type="vault"></app-skeleton-loading>
</ng-template>
