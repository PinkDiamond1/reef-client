<ng-container *ngIf="contract$ | async as contract">
  <ng-container *ngIf="!(loading$ | async); else loadingTemplate">
    <ng-container *ngIf="!(basketsError$ | async); else errorTemplate">
    <ng-container *ngIf="baskets$ | async as allBaskets; else loadingTemplate">
      <ng-container *ngIf="allBaskets.length; else emptyStateTemplate">
        <div class="mb-3" *ngFor="let basket of allBaskets; let i = index;">
          <app-basket
            [basket]="basket"
            [basketIndex]="i"
            (disinvest)="onDisinvest($event)"></app-basket>
        </div>
      </ng-container>
    </ng-container>
    </ng-container>
  </ng-container>
</ng-container>

<ng-template #loadingTemplate>
  <app-loading [isWholePage]="true"></app-loading>
</ng-template>

<ng-template #emptyStateTemplate>
  <app-empty-state
    title="No baskets"
    subtitle="You have not invested in any baskets"
    [showCtaButton]="true"
    ctaButtonText="Start Investing!"
    (cta)="goToCreate()"
  ></app-empty-state>
</ng-template>

<ng-template #errorTemplate>
  <app-empty-state
    title="Whoops."
    subtitle="Something went wrong with fetching the baskets. Try again in a bit."
  ></app-empty-state>
</ng-template>
